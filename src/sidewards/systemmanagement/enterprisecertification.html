<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>企业认证</title>
    <link rel="stylesheet" href="../../../public/dist/css/layui.css">
    <link rel="stylesheet" href="../../../css/enterprisecertification.css">
    <link rel="stylesheet" href="../../../public/font/iconfont.css">
</head>

<body>
    <form class="layui-form" action="">
        <div class="container">
            <div class="header">
                <div class="header-line">
                    <div class="header-icon">
                        <i class="layui-icon layui-icon-ok-circle" style="font-size: 38px; color: #fff;"></i>
                    </div>
                    <div class="line"></div>
                    <div class="header-icon">
                        <i class="layui-icon layui-icon-ok-circle" style="font-size: 38px; color: #fff;"></i>
                    </div>
                    <div class="line"></div>
                    <div class="header-icon">
                        <i class="layui-icon layui-icon-ok-circle" style="font-size: 38px; color: #fff;"></i>
                    </div>
                </div>

                <div class="header-content">

                    <div class="header-content-item">
                        <div class="header-content-txt">营业执照</div>
                        <div class="header-content-btn" id="ok1">未录入</div>
                    </div>
                    <div class="header-content-item">
                        <div class="header-content-txt">法人身份证</div>
                        <div class="header-content-btn" id="ok2">未录入</div>
                    </div>
                    <div class="header-content-item">
                        <div class="header-content-txt">授权书认证</div>
                        <div class="header-content-btn" id="ok3">未录入</div>
                    </div>
                </div>

            </div>



            <div class="content">
                <div class="license">
                    <div class="license-nav">
                        营业执照
                        <div class="btn" id="ok4">
                            未录入
                        </div>
                    </div>
                    <div class="license-content">
                        <img class="license-img" src="" id="ok5">



                        <div class="license-txt">
                            企业认证，分为企业信息认证，法人认证以及管理员授权认证，对申请使用企业动力云平台的企业进行“企业的合法性、真实性”的核实，以及“申请人是否隶属该企业且经过企业授权”的查证；通过认证的企业，方拥有企业动力云平台的所有功能操作的权限。
                        </div>
                    </div>

                    <div class="select" id="rerererre">
                        <div class="select-item">
                            <div class="select-item-text">
                                企业名称
                            </div>
                            <input type="text" class="layui-input select-item-input" id="qiyess">
                        </div>

                        <div class="select-item">
                            <div class="select-item-text">
                                企业证件号
                            </div>
                            <input type="text" class="layui-input select-item-input" id="hao">
                        </div>
                        <div class="select-item">
                            <div class="select-item-text">
                                联系人
                            </div>
                            <input type="text" class="layui-input select-item-input">
                        </div>

                        <div class="select-item">
                            <div class="select-item-text">
                                联系人电话
                            </div>
                            <input type="text" class="layui-input select-item-input">
                        </div>
                        <div class="select-item">
                            <div class="select-item-text">
                                省
                            </div>
                            <select name="sen" lay-filter="sen" class="select-item-select2" id="sheng">
                          
                        </select>
                        </div>

                        <div class="select-item">
                            <div class="select-item-text">
                                市
                            </div>
                            <select class="select-item-select2" id="shi" lay-filter="shis" name="shi">
                           
                            </select>
                        </div>

                        <div class="select-item">
                            <div class="select-item-text">
                                区
                            </div>
                            <select class="select-item-select2" id="qu" lay-filter="qus" name="qu">
                           
                        </select>
                        </div>

                        <div class="select-item">
                            <div class="select-item-text">
                                证件有效期
                            </div>
                            <input type="text" class="layui-input select-item-input" id="youx">
                            <div class="tip-btn">
                                长期
                            </div>
                        </div>


                        <div class="select-item2">
                            <div class="select-item-text">
                                注册企业详细地址
                            </div>
                            <textarea class="select-area"></textarea>
                        </div>
                    </div>



                    <div class="upload">
                        <div class="upload-nav">
                            上传证件(图片大小不得超过2M)
                        </div>
                        <div class="upload-content" style="display: flex;">
                            <div style="margin-right: 10px;">
                                <img src="" alt="" id="ingss">
                                <div class="upload-btns">
                                    <div class="upload-btn" style="cursor: pointer;margin-left: 25px;" id="shang">上传</div>
                                    <!-- <div class="upload-btn" style="cursor: pointer;">删除</div> -->
                                </div>
                                <div class="upload-txt">营业执照</div>
                            </div>

                            <div>
                                <img src="" alt="" id="fardden">
                                <div class="upload-btns">
                                    <div class="upload-btn" style="cursor: pointer;margin-left: 25px;" id="faren">上传</div>
                                    <!-- <div class="upload-btn" style="cursor: pointer;">删除</div> -->
                                </div>
                                <div class="upload-txt" style="width: 110px;">法人身份证(正面)</div>
                            </div>


                        </div>
                    </div>
                </div>

                <div class="save" id="bao" style="cursor:pointer;">保存</div>
            </div>
        </div>

    </form>


</body>
<script src="../../../public/dist/layui.js" charset="utf-8"></script>
<!-- <script src="../../../js/enterprisecertification.js" charset="utf-8"></script> -->
<script src="../../../js/common/jquery.min.js"></script>
<script src="../../../js/common/api.js"></script>
<script src="../../../js/module/jquery-3.4.1.min.js"></script>
<script>
</script>

</html>
<script>
    layui.use(['upload', 'form', 'element', 'table', "layer", "laydate", "util"], function() {
        var $ = layui.jquery,
            table = layui.table,
            layer = layui.layer,
            laydate = layui.laydate,
            util = layui.util,
            form = layui.form,
            element = layui.element,
            obj = {},
            upload = layui.upload;


        //省
        handleAjax('enterprise/getProvincecity', {}, "GET").done(function(resp) {
            console.log(resp)
            $.each(resp.list, function(index, item) {
                $('#sheng').append(new Option(item.fullName, item.code)); // 下拉菜单里添加元素
            });
            form.render();
            return
        }).fail(function(err) {
            console.log(err)
        });


        //市
        form.on('select(sen)', function(data) {
            handleAjax('enterprise/getProvincecity', {
                parentid: data.value
            }, "GET").done(function(resp) {
                $.each(resp.list, function(index, item) {
                    $('#shi').append(new Option(item.fullName, item.code)); // 下拉菜单里添加元素
                });
                layui.form.render("select");
                return
            }).fail(function(err) {
                console.log(err)
            });
            return
        })

        //区
        form.on('select(shis)', function(data) {
            handleAjax('enterprise/getProvincecity', {
                parentid: data.value
            }, "GET").done(function(resp) {
                $.each(resp.list, function(index, item) {
                    $('#qu').append(new Option(item.fullName, item.code)); // 下拉菜单里添加元素
                });
                layui.form.render("select");
                return
            }).fail(function(err) {
                console.log(err)
            });
            return
        })


        //上传图片营业
        var uploadInst = upload.render({
            elem: '#shang',
            url: baseaip + "file/upload",
            accept: 'file',
            field: "file",
            done: function(res) {
                var ss = res.data.split("|");
                layer.msg(res.msg);
                $("#ingss").attr("src", ss[0]);
                $("#ok1").text("已录入");
                $("#ok4").text("已录入");
                $("#ok5").attr("src", ss[0]);
                obj.ying = ss[0];
            },
            error: function(res) {
                layer.msg(res.msg);
            }
        });

        //上传图片|法人
        var uploadInst = upload.render({
            elem: '#faren',
            url: baseaip + "file/upload",
            accept: 'file',
            field: "file",
            done: function(res) {
                var ss = res.data.split("|");
                layer.msg(res.msg);
                $("#fardden").attr("src", ss[0]);
                $("#ok2").text("已录入");
                obj.faren = ss[0];
            },
            error: function(res) {
                layer.msg(res.msg);
            }
        });


        Theoldcuiway('dictionaries/query', {
            type: "fsfsfssfuieinxhbe",
            keyword: "objniukey"
        }, "GET").done(function(resp) {
            console.log(resp)
                // resp = JSON.parse(resp.data.content)
            if (resp.length <= 0) {

                $("#rerererre").css("display", "block");
            } else {
                $("#rerererre").css("display", "none");
                $("#ok3").text("已录入");
                $("#ok1").text("已录入");
                $("#ok2").text("已录入");
                $("#bao").css("display", "none");
                $("#shang").css("display", "none");
                $("#faren").css("display", "none");
                $("#ok4").css("display", "none");

            }
            resp = resp.data.content[0].context;
            resp = JSON.parse(resp)
            console.log(resp)
            $("#fardden").attr("src", resp.faren);
            $("#ok5").attr("src", resp.ying);
            $("#ingss").attr("src", resp.ying);
            return
        }).fail(function(err) {
            console.log(err)
        });



        $("#bao").click(function() {
            if (!obj.ying) {
                layer.msg("请上传营业执照");
                return
            }

            if (!obj.faren) {
                layer.msg("请上传法人身份证");
                return
            }

            if ($("#qiyess") == "") {
                layer.msg("请输入企业名称");
                return
            }

            if ($("#hao") == "") {
                layer.msg("请输入企业企业证件号");
                return
            }

            if ($("#youx") == "") {
                layer.msg("证件有效期");
                return
            }

            obj = JSON.stringify(obj)
            Theoldcuiway('dictionaries/saveOrUpdate', {
                type: "fsfsfssfuieinxhbe",
                context: obj,
                keyword: "objniukey"
            }, "POST").done(function(resp) {
                console.log(resp)
                layer.msg("上传成功!");
                window.location.reload()
                return
            }).fail(function(err) {
                console.log(err)
            });

        })


    })
</script>